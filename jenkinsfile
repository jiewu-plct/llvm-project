node("x86_runner1"){
    stage('*** Cleanup***') {
        cleanWs()
    }
    stage('*** Check out SCM ***') {
        checkout scm
    } 
    stage('*** Compilation Phase ***') { 
        sh '''#!/bin/bash
            mkdir build && cd build
            module load cmake/3.27.6
            cmake -DLLVM_PARALLEL_LINK_JOBS=3 -DCMAKE_BUILD_TYPE=Release -DLLVM_TARGETS_TO_BUILD="X86;RISCV" -DLLVM_ENABLE_PROJECTS="clang" -G Ninja ../llvm
            ninja
         '''
    }
    stage (' *** Test ***'){
        sh '''#!/bin/bash
            cd build
            bin/clang -v
            bin/llvm-objdump --version | grep riscv
         '''
    }
}
